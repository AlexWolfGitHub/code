// Generated by CoffeeScript 1.9.3

define(["angular", "framework/datasource/DataSourceModule", "framework/interceptors/GlobalInterceptorModule"], function (angular, DataSourceModule) {
    var TestDataSourceModule;
    TestDataSourceModule = angular.module("TestDataSourceModule", ["GlobalInterceptorModule", "DataSourceModule"]);
    TestDataSourceModule.controller("DSController", function ($scope, $dataSourceManager, $dataSource) {
        $scope.testParams = {
            hello: 3
        };

        var i = 0;
        $scope.config = {
            sortName: "Hello"
        }
        $scope.changeSortName = function () {
            $dataSourceManager.dataSources['source1'].sortName = $scope.config.sortName + "" + (i++);
        }


        var source3 = new $dataSource("source3", ["1", "2", "3"]);

        $dataSourceManager.getDataSource("source3").then(function (dataSource) {
            console.info(dataSource);
        });

        $scope.$on("source3", function (sourceName, dataSource) {
            console.info(arguments)
        });

        $scope.changeCustomerDataSource = function () {
            source3.records = [7, 8, 89, 9, 50, 0];
        }


        $dataSourceManager.getDataSource("source1").then(function (dataSource) {
            $scope.nextPage = function () {
                dataSource.currentPage = dataSource.currentPage + 1;
            };
            $scope.fresh = function () {
                dataSource.doRequestData()
            }
            $scope.setParams = function () {
                return dataSource.params = function () {
                    return {
                        name: "hello "
                    };
                };
            };
            $scope.setPageSize = function () {
                dataSource.pageSize = 20;
            };
            return $scope.$on("source1", function (event, obj) {
                console.info("hello");
            });
        });
        $scope.params = $scope.search;
    });
});
